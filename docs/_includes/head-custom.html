<style>
/* Code block copy button */
.code-header {
  display: flex;
  justify-content: flex-end;
  background: #1b1f23;
  border-radius: 6px 6px 0 0;
  padding: 4px 8px;
  margin-top: 16px;
}

.copy-btn {
  background: #30363d;
  border: 1px solid #484f58;
  border-radius: 4px;
  color: #8b949e;
  cursor: pointer;
  font-size: 12px;
  padding: 4px 8px;
  transition: all 0.2s;
}

.copy-btn:hover {
  background: #484f58;
  color: #c9d1d9;
}

.copy-btn.copied {
  background: #238636;
  border-color: #238636;
  color: #fff;
}

/* Adjust pre styling when wrapped */
.code-wrapper pre {
  margin-top: 0;
  border-radius: 0 0 6px 6px;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Find all code blocks
  document.querySelectorAll('pre').forEach(function(pre) {
    // Skip if already wrapped
    if (pre.parentNode.classList.contains('code-wrapper')) return;

    // Create wrapper
    const wrapper = document.createElement('div');
    wrapper.className = 'code-wrapper';

    // Create header with copy button
    const header = document.createElement('div');
    header.className = 'code-header';

    const btn = document.createElement('button');
    btn.className = 'copy-btn';
    btn.textContent = 'Copy';
    btn.addEventListener('click', function() {
      const code = pre.querySelector('code') || pre;
      navigator.clipboard.writeText(code.textContent).then(function() {
        btn.textContent = 'Copied!';
        btn.classList.add('copied');
        setTimeout(function() {
          btn.textContent = 'Copy';
          btn.classList.remove('copied');
        }, 2000);
      });
    });

    header.appendChild(btn);

    // Wrap the pre element
    pre.parentNode.insertBefore(wrapper, pre);
    wrapper.appendChild(header);
    wrapper.appendChild(pre);
  });
});
</script>
